#!/usr/bin/env bash
# This script modifies /etc/hosts so localhost resolves to 127.0.0.2 and facebook.com to 8.8.8.8

tmp_file=$(mktemp)

# Copy current hosts to tmp_file
cat /etc/hosts > "$tmp_file"

# Remove any line containing 'localhost' or 'facebook.com'
sed -i '/localhost/d' "$tmp_file"
sed -i '/facebook.com/d' "$tmp_file"

# Append exactly what the test expects
echo -e "127.0.0.2\tlocalhost" >> "$tmp_file"
echo -e "8.8.8.8\tfacebook.com" >> "$tmp_file"

# Replace /etc/hosts with tmp_file
sudo mv "$tmp_file" /etc/hosts
